{% extends "StudiiFezabilitate/CU/base_CU_SF.html" %}




{% block body %}
<h3 class="text-center m-4">Editează Certificatul de urbanism</h3>
<div class="row justify-content-center">
    <div class="col-10">
        <div class="card bg-light mb-3">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div>
                    <i class="fa-solid fa-pen-to-square fa-lg"></i> Editează Certificatul de urbanism
                </div>
                <div class="d-flex gap-2">
                    <a href="{% url 'index_CU' lucrare.id %}" class="btn btn-outline-secondary btn-sm">Anulează</a>
                    <button type="submit" class="btn btn-primary btn-sm" form="edit-cu-form">Salvează</button>
                </div>
            </div>
            <div class="card-body">
                <form id="edit-cu-form" method="POST" enctype="multipart/form-data" novalidate>
                    {% csrf_token %}

                    <!-- Emitent centered -->
                    <div class="row my-3">
                        <div class="col-12">
                            <div class="mx-auto" style="max-width: 640px;">
                                <div class="form-group text-center">
                                    <label for="{{ form.emitent.id_for_label }}" class="form-label">{{ form.emitent.label }}{% if form.emitent.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                    {{ form.emitent }}
                                    {% if form.emitent.errors %}
                                    <div class="invalid-feedback d-block">{{ form.emitent.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2nd row: Număr, Data, Valabilitate, Suprafață, Lungime -->
                    <div class="row g-3">
                        <div class="col-12 col-md-4 col-lg-2">
                            <div class="form-group">
                                <label for="{{ form.numar.id_for_label }}" class="form-label">{{ form.numar.label }}{% if form.numar.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.numar }}
                                {% if form.numar.errors %}
                                <div class="invalid-feedback d-block">{{ form.numar.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-12 col-md-4 col-lg-2">
                            <div class="form-group">
                                <label for="{{ form.data.id_for_label }}" class="form-label">{{ form.data.label }}{% if form.data.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.data }}
                                {% if form.data.errors %}
                                <div class="invalid-feedback d-block">{{ form.data.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-12 col-md-4 col-lg-2">
                            <div class="form-group">
                                <label for="{{ form.valabilitate.id_for_label }}" class="form-label">{{ form.valabilitate.label }}{% if form.valabilitate.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.valabilitate }}
                                {% if form.valabilitate.errors %}
                                <div class="invalid-feedback d-block">{{ form.valabilitate.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-lg-3">
                            <div class="form-group">
                                <label for="{{ form.suprafata_ocupata.id_for_label }}" class="form-label">{{ form.suprafata_ocupata.label }}{% if form.suprafata_ocupata.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.suprafata_ocupata }}
                                {% if form.suprafata_ocupata.errors %}
                                <div class="invalid-feedback d-block">{{ form.suprafata_ocupata.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-lg-3">
                            <div class="form-group">
                                <label for="{{ form.lungime_traseu.id_for_label }}" class="form-label">{{ form.lungime_traseu.label}}{% if form.lungime_traseu.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.lungime_traseu }}
                                {% if form.lungime_traseu.errors %}
                                <div class="invalid-feedback d-block">{{ form.lungime_traseu.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>



                    <!-- Nume & Adresa -->
                    <div class="row g-3">
                        <div class="col-12">
                            <div class="form-group">
                                <label for="{{ form.nume.id_for_label }}" class="form-label">{{ form.nume.label }}{% if form.nume.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.nume }}
                                {% if form.nume.errors %}
                                <div class="invalid-feedback d-block">{{ form.nume.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label for="{{ form.adresa.id_for_label }}" class="form-label">{{ form.adresa.label }}{% if form.adresa.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.adresa }}
                                {% if form.adresa.errors %}
                                <div class="invalid-feedback d-block">{{ form.adresa.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Ingineri -->
                    <div class="row g-3 mt-1">
                        <div class="col-12 col-md-6">
                            <div class="form-group">
                                <label for="{{ form.inginer_intocmit.id_for_label }}" class="form-label">{{ form.inginer_intocmit.label}}{% if form.inginer_intocmit.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.inginer_intocmit }}
                                {% if form.inginer_intocmit.errors %}
                                <div class="invalid-feedback d-block">{{ form.inginer_intocmit.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="form-group">
                                <label for="{{ form.inginer_verificat.id_for_label }}" class="form-label">{{ form.inginer_verificat.label}}{% if form.inginer_verificat.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                                {{ form.inginer_verificat }}
                                {% if form.inginer_verificat.errors %}
                                <div class="invalid-feedback d-block">{{ form.inginer_verificat.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Descrierea proiectului -->
                    <div class="form-group mt-3">
                        <label for="{{ form.descrierea_proiectului.id_for_label }}" class="form-label">{{ form.descrierea_proiectului.label }}{% if form.descrierea_proiectului.field.required %} <span class="text-danger" title="Obligatoriu">*</span>{% endif %}</label>
                        {{ form.descrierea_proiectului }}
                        {% if form.descrierea_proiectului.errors %}
                        <div class="invalid-feedback d-block">{{ form.descrierea_proiectului.errors }}</div>
                        {% endif %}
                    </div>



                    <!-- Documente -->
                    <hr class="my-4">
                    <h5 class="mb-3">Documente</h5>
                    <div class="row">
                        <!-- Left column documents -->
                        <div class="col-md-6">
                            <!-- Cale Certificat de urbanism -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_CU.id_for_label }}" class="form-label">{{ form.cale_CU.label }}</label>
                                {% if form.instance.cale_CU %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_CU' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_CU.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel existent.</small>
                                </div>
                                {% endif %}
                                <div>
                                    {{ form.cale_CU }}
                                    {% if form.cale_CU.errors %}
                                    <div class="invalid-feedback d-block">{{ form.cale_CU.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Plan de incadrare CU -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_plan_incadrare_CU.id_for_label }}" class="form-label">{{ form.cale_plan_incadrare_CU.label }}</label>
                                {% if form.instance.cale_plan_incadrare_CU %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_plan_incadrare_CU' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_plan_incadrare_CU.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel existent.</small>
                                </div>
                                {% endif %}
                                <div>
                                    {{ form.cale_plan_incadrare_CU }}
                                    {% if form.cale_plan_incadrare_CU.errors %}
                                    <div class="invalid-feedback d-block">{{ form.cale_plan_incadrare_CU.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Plan de situatie CU -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_plan_situatie_CU.id_for_label }}" class="form-label">{{ form.cale_plan_situatie_CU.label }}</label>
                                {% if form.instance.cale_plan_situatie_CU %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_plan_situatie_CU' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_plan_situatie_CU.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel existent.</small>
                                </div>
                                {% endif %}
                                <div>
                                    {{ form.cale_plan_situatie_CU }}
                                    {% if form.cale_plan_situatie_CU.errors %}
                                    <div class="invalid-feedback d-block">{{ form.cale_plan_situatie_CU.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Memoriu tehnic CU -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_memoriu_tehnic_CU.id_for_label }}" class="form-label">{{ form.cale_memoriu_tehnic_CU.label }}</label>
                                {% if form.instance.cale_memoriu_tehnic_CU %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_memoriu_tehnic_CU' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_memoriu_tehnic_CU.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel existent.</small>
                                </div>
                                {% endif %}
                                <div>
                                    {{ form.cale_memoriu_tehnic_CU }}
                                    {% if form.cale_memoriu_tehnic_CU.errors %}
                                    <div class="invalid-feedback d-block">{{ form.cale_memoriu_tehnic_CU.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Acte beneficiar -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_acte_beneficiar.id_for_label }}" class="form-label">{{ form.cale_acte_beneficiar.label }}</label>
                                {% if form.instance.cale_acte_beneficiar %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_acte_beneficiar' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_acte_beneficiar.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel existent.</small>
                                </div>
                                {% endif %}
                                <div>
                                    {{ form.cale_acte_beneficiar }}
                                    {% if form.cale_acte_beneficiar.errors %}
                                    <div class="invalid-feedback d-block">{{ form.cale_acte_beneficiar.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Acte facturare -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_acte_facturare.id_for_label }}" class="form-label">{{ form.cale_acte_facturare.label }}</label>
                                {% if form.instance.cale_acte_facturare %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_acte_facturare' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_acte_facturare.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel existent.</small>
                                </div>
                                {% endif %}
                                <div>
                                    {{ form.cale_acte_facturare }}
                                    {% if form.cale_acte_facturare.errors %}
                                    <div class="invalid-feedback d-block">{{ form.cale_acte_facturare.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Chitanță APM -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_chitanta_APM.id_for_label }}" class="form-label">{{ form.cale_chitanta_APM.label }}</label>
                                {% if form.instance.cale_chitanta_APM %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_chitanta_APM' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_chitanta_APM.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel existent.</small>
                                </div>
                                {% endif %}
                                <div>
                                    {{ form.cale_chitanta_APM }}
                                    {% if form.cale_chitanta_APM.errors %}
                                    <div class="invalid-feedback d-block">{{ form.cale_chitanta_APM.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Right column documents -->
                        <div class="col-md-6">
                            <!-- Cale Plan de situație - LA SCARA -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_plan_situatie_la_scara.id_for_label }}" class="form-label">
                                    {{ form.cale_plan_situatie_la_scara.label }}
                                </label>

                                {% if form.instance.cale_plan_situatie_la_scara %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_plan_situatie_la_scara' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_plan_situatie_la_scara.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">
                                        Încărcați un nou fișier doar dacă doriți să-l
                                        înlocuiți pe cel existent.
                                    </small>
                                </div>
                                {% endif %}

                                <div>
                                    {{ form.cale_plan_situatie_la_scara }}
                                    {% if form.cale_plan_situatie_la_scara.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.cale_plan_situatie_la_scara.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Plan de situație - DWG -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_plan_situatie_DWG.id_for_label }}" class="form-label">
                                    {{ form.cale_plan_situatie_DWG.label }}
                                </label>

                                {% if form.instance.cale_plan_situatie_DWG %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_plan_situatie_DWG' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_plan_situatie_DWG.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">
                                        Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe cel
                                        existent.
                                    </small>
                                </div>
                                {% endif %}

                                <div>
                                    {{ form.cale_plan_situatie_DWG }}
                                    {% if form.cale_plan_situatie_DWG.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.cale_plan_situatie_DWG.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Extrase CF -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_extrase_CF.id_for_label }}" class="form-label">
                                    {{ form.cale_extrase_CF.label }}
                                </label>

                                {% if form.instance.cale_extrase_CF %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_extrase_CF' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_extrase_CF.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">
                                        Încărcați un nou fișier doar dacă doriți să-l înlocuiți pe
                                        cel
                                        existent.
                                    </small>
                                </div>
                                {% endif %}

                                <div>
                                    {{ form.cale_extrase_CF }}
                                    {% if form.cale_extrase_CF.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.cale_extrase_CF.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Aviz GIS -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_aviz_GIS.id_for_label }}" class="form-label">
                                    {{ form.cale_aviz_GIS.label }}
                                </label>

                                {% if form.instance.cale_aviz_GIS %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_aviz_GIS' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_aviz_GIS.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">
                                        Încărcați un nou fișier doar dacă doriți să-l înlocuiți
                                        pe
                                        cel
                                        existent.
                                    </small>
                                </div>
                                {% endif %}

                                <div>
                                    {{ form.cale_aviz_GIS }}
                                    {% if form.cale_aviz_GIS.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.cale_aviz_GIS.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Cale Chitanță DSP -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_chitanta_DSP.id_for_label }}" class="form-label">
                                    {{ form.cale_chitanta_DSP.label }}
                                </label>

                                {% if form.instance.cale_chitanta_DSP %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_chitanta_DSP' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_chitanta_DSP.name
                                            }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">
                                        Încărcați un nou fișier doar dacă doriți
                                        să-l
                                        înlocuiți
                                        pe
                                        cel
                                        existent.
                                    </small>
                                </div>
                                {% endif %}

                                <div>
                                    {{ form.cale_chitanta_DSP }}
                                    {% if form.cale_chitanta_DSP.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.cale_chitanta_DSP.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            {% if lucrare and lucrare.judet and lucrare.judet.nume %}
                            {% if lucrare.judet.nume == 'Botoșani' %}
                            <!-- Cale Chitanță IPJ Botoșani -->
                            <div class="form-group mb-4">
                                <label for="{{ form.cale_chitanta_IPJ_Botosani.id_for_label }}" class="form-label">
                                    {{ form.cale_chitanta_IPJ_Botosani.label }}
                                </label>

                                {% if form.instance.cale_chitanta_IPJ_Botosani %}
                                <div class="mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="far fa-file-pdf text-danger me-2"></i>
                                        <a href="{% url 'download_file' 'certificaturbanism' 'cale_chitanta_IPJ_Botosani' lucrare.id %}" class="text-decoration-none">
                                            {{ form.instance.cale_chitanta_IPJ_Botosani.name }}
                                            <i class="fas fa-download ms-1 small"></i>
                                        </a>
                                    </div>
                                    <small class="text-muted">
                                        Încărcați un nou fișier doar dacă doriți să-l
                                        înlocuiți pe cel existent.
                                    </small>
                                </div>
                                {% endif %}

                                <div>
                                    {{ form.cale_chitanta_IPJ_Botosani }}
                                    {% if form.cale_chitanta_IPJ_Botosani.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.cale_chitanta_IPJ_Botosani.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <!-- Bottom actions -->
                    <hr class="my-4">
                    <div class="d-flex justify-content-end gap-2">
                        <a href="{% url 'index_CU' lucrare.id %}" class="btn btn-outline-secondary">Anulează</a>
                        <button type="submit" class="btn btn-primary">Salvează</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}